# FTMO Prop Trading Rules — 2-Step Challenge

> Правила FTMO для автоматизированного трейдинга. Агент **ОБЯЗАН** соблюдать все лимиты.
> Нарушение любого правила = потеря аккаунта.

---

## Step 1: FTMO Challenge

| Параметр                 | Значение                                               |
| ------------------------ | ------------------------------------------------------ |
| **Profit Target**        | **10%** от начального баланса                          |
| **Maximum Daily Loss**   | **5%** от баланса на начало дня (или equity, что выше) |
| **Maximum Total Loss**   | **10%** от начального баланса                          |
| **Trading Period**       | **30 календарных дней**                                |
| **Minimum Trading Days** | **4 дня** (сделки в 4 разных дня)                      |
| **Leverage**             | до **1:100** (Forex)                                   |

### Пример (аккаунт $100,000):

- Profit Target: $10,000
- Max Daily Loss: $5,000
- Max Total Loss: $10,000 (equity не ниже $90,000)

---

## Step 2: Verification

| Параметр                 | Значение                                               |
| ------------------------ | ------------------------------------------------------ |
| **Profit Target**        | **5%** от начального баланса                           |
| **Maximum Daily Loss**   | **5%** от баланса на начало дня (или equity, что выше) |
| **Maximum Total Loss**   | **10%** от начального баланса                          |
| **Trading Period**       | **60 календарных дней**                                |
| **Minimum Trading Days** | **4 дня** (сделки в 4 разных дня)                      |
| **Leverage**             | до **1:100** (Forex)                                   |

### Пример (аккаунт $100,000):

- Profit Target: $5,000
- Max Daily Loss: $5,000
- Max Total Loss: $10,000 (equity не ниже $90,000)

---

## FTMO Funded Account (после прохождения обоих шагов)

| Параметр               | Значение                                  |
| ---------------------- | ----------------------------------------- |
| **Profit Target**      | Нет (торгуешь без ограничения по времени) |
| **Maximum Daily Loss** | **5%**                                    |
| **Maximum Total Loss** | **10%**                                   |
| **Profit Split**       | **80/20** (80% трейдеру, 20% FTMO)        |
| **Scaling Plan**       | до **90/10** при стабильных результатах   |
| **Выплаты**            | каждые 14 дней (по запросу)               |

---

## Расчёт Maximum Daily Loss (КРИТИЧНО)

> ⚠️ **Daily Loss считается от БОЛЬШЕГО из двух значений**: баланс на начало дня ИЛИ equity на начало дня.

Формула:

```
Daily Loss Limit = max(balance_start_of_day, equity_start_of_day) × 5%
```

**Включает**: реализованный P&L + нереализованный P&L (floating) + комиссии + свопы.

Пример:

- Balance start of day: $102,000
- Equity start of day: $103,500 (есть открытые позиции в плюсе)
- Daily Loss Limit = $103,500 × 5% = **$5,175**
- Минимально допустимая equity за день: $103,500 - $5,175 = **$98,325**

---

## Расчёт Maximum Total Loss (КРИТИЧНО)

> ⚠️ **Total Loss считается от НАЧАЛЬНОГО баланса аккаунта** (initial balance).

Формула:

```
Max Total Loss = initial_balance × 10%
Minimum Equity = initial_balance - (initial_balance × 10%) = initial_balance × 90%
```

Пример (аккаунт $100,000):

- Max Total Loss: $10,000
- Equity НИКОГДА не должна опуститься ниже **$90,000**

---

## Допустимые инструменты

### Forex (основные пары — торгуемые агентом):

- EUR/USD, GBP/USD, USD/JPY, AUD/USD, USD/CAD, NZD/USD
- EUR/GBP, EUR/JPY, GBP/JPY и другие кроссы

### Другие инструменты (доступны на FTMO):

- Индексы: US30, US100, US500, GER40, UK100
- Металлы: XAU/USD (золото), XAG/USD (серебро)
- Криптовалюты: BTC/USD, ETH/USD (ограниченный леверидж)
- Энергия: USOIL, UKOIL

---

## Запрещённые стратегии и ограничения

### 1. Торговля на новостях

- **Ограничение**: запрещено открывать/закрывать/модифицировать позиции в окне **±2 минуты** вокруг новостей с высоким импактом (High Impact News)
- Это касается инструментов, напрямую связанных с валютой новости
- Пример: NFP (Non-Farm Payrolls) → нельзя торговать USD пары ±2 мин
- **Для агента**: не торговать за **30 минут** до и после важных новостей (дополнительный буфер безопасности)

### 2. Удержание позиций через выходные (Weekend Holding)

- **Разрешено** на FTMO (нет запрета)
- Однако гэпы на открытии могут создать риски для daily/total drawdown
- **Рекомендация для агента**: закрывать все позиции перед выходными (пятница 21:00 UTC) если нет сильного основания для удержания

### 3. Запрещённые стратегии

- **Martingale** (увеличение лота после убытка) — строго запрещено
- **Grid trading** без стоп-лоссов — запрещено
- **HFT / Latency arbitrage** — запрещено
- **Copy trading** с другого FTMO аккаунта — запрещено
- **Hedging между FTMO аккаунтами** — запрещено (hedging на одном аккаунте разрешено)
- **Tick scalping** (сделки длительностью менее нескольких секунд) — не рекомендуется
- **Использование exploit'ов** платформы — запрещено

### 4. Gambling / Избыточный риск

- Открытие непропорционально больших позиций — нарушение
- Вся торговля должна быть обоснована (стратегия, анализ)

---

## Правило неактивности (Inactivity)

- **Challenge/Verification**: если нет сделки в течение **30 календарных дней** — аккаунт может быть закрыт
- **Funded Account**: минимум **1 сделка в 30 дней**
- **Для агента**: обеспечить минимум 1 торговый день в неделю

---

## Scaling Plan

При стабильных результатах на Funded Account:

1. Торговля ≥ 4 месяцев с прибылью
2. Прибыль ≥ 10% за период (суммарно)
3. Увеличение баланса на **25%** от начального
4. Profit split увеличивается: **80/20 → 90/10**

---

## Торговые часы

- Forex: **Воскресенье 22:05 UTC — Пятница 21:00 UTC** (круглосуточно)
- Индексы/Металлы: зависит от инструмента
- Для агента: торговать в **Лондон + Нью-Йорк** сессии (лучшая ликвидность)

---

## Безопасные лимиты для агента (СТРОЖЕ чем FTMO)

> Агент использует более консервативные лимиты чтобы оставить буфер безопасности.

| Параметр             | FTMO лимит | Лимит агента  | Буфер        |
| -------------------- | ---------- | ------------- | ------------ |
| Max Daily Loss       | 5.0%       | **4.0%**      | 1.0%         |
| Max Total Loss       | 10.0%      | **8.0%**      | 2.0%         |
| Риск на сделку       | до 5%      | **1.0–2.0%**  | Значительный |
| Max открытых позиций | Без лимита | **3**         | —            |
| Новости: буфер       | ±2 мин     | **±30 мин**   | 28 мин       |
| Weekend holding      | Разрешено  | **Закрывать** | —            |

Эти лимиты заданы в `src/trading/forex/config.ts`:

- `maxDailyDrawdownPct: 4.0` (FTMO: 5.0)
- `maxTotalDrawdownPct: 8.0` (FTMO: 10.0)
- `maxRiskPerTradePct: 1.0` (FTMO: без ограничения, но здравый смысл)
- `maxOpenPositions: 3`

---

## Чек-лист перед каждой сделкой (FTMO compliance)

```
□ Проверить daily drawdown (текущий % от лимита)
□ Проверить total drawdown (текущий % от лимита)
□ Есть ли High Impact новости в ближайшие 30 мин?
□ Размер позиции ≤ 2% риска от баланса
□ Stop Loss установлен
□ Risk:Reward ≥ 1:2
□ Не более 3 открытых позиций
□ Не пятница вечер (weekend risk)
□ Стратегия не нарушает правила FTMO
```

---

## Ссылки

- FTMO Trading Rules: https://ftmo.com/en/trading-rules/
- FTMO FAQ: https://ftmo.com/en/faq/
- FTMO Scaling Plan: https://ftmo.com/en/scaling-plan/
- FTMO Objectives: https://ftmo.com/en/trading-objectives/
